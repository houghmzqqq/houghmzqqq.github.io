---
title: js中的正则表达式
date: 2018-07-13 11:04:33
tags: 
	- js
---

**首先需要说明，在js的正则表达式中，'\'（即反斜杠）表示转义，而非'/'。基本的写法是：/匹配的字符/修饰(可选)，匹配的字符包含在两个斜杠中间。**

## 1.基本语法

### 1.1元字符

| 元字符  | 描述                  | 元字符  | 描述             |
| ---- | ------------------- | ---- | -------------- |
| \d   | 匹配数字                | \f   | 匹配换页符          |
| \s   | 匹配空白字符              | \n   | 匹配换行符          |
| \b   | 匹配字母                | \r   | 匹配回车符          |
| \w   | 表示单词字符，={a-zA-Z0-9} | ^    | 表示后面出现的字符必须在开头 |
| +    | 表示出现一到多次，={1,}      | .    | 匹配任意字符         |
| $    | 表示前面出现的字符必须在结尾      | \S   | 表示非空格符         |
| *    | 表示出现0到多次，={0,}      | \b   | 匹配一个单词的边界      |
| ？    | 表示出现0次或一次，={0,1}    |      |                |

<!-- more -->

[举例1：表达式 "^aaa" 在匹配 "xxx aaa xxx" 时](http://www.regexlab.com/zh/workshop.asp?pat=%5Eaaa&txt=xxx+aaa+xxx)，匹配结果是：失败。因为 "^" 要求与字符串开始的地方匹配，因此，只有当 "aaa" 位于字符串的开头的时候，"^aaa" 才能匹配，[比如："aaa xxx xxx"](http://www.regexlab.com/zh/workshop.asp?pat=%5Eaaa&txt=aaa+xxx+xxx)。

[举例2：表达式 "aaa$" 在匹配 "xxx aaa xxx" 时](http://www.regexlab.com/zh/workshop.asp?pat=aaa$&txt=xxx+aaa+xxx)，匹配结果是：失败。因为 "$" 要求与字符串结束的地方匹配，因此，只有当 "aaa" 位于字符串的结尾的时候，"aaa$" 才能匹配，[比如："xxx xxx aaa"](http://www.regexlab.com/zh/workshop.asp?pat=aaa$&txt=xxx+xxx+aaa)。

[举例3：表达式 "\b" 在匹配 "@@@abc" 时](http://www.regexlab.com/zh/workshop.asp?pat=.%5Cb.&txt=@@@abc)，匹配结果是：成功；匹配到的内容是："@a"；匹配到的位置是：开始于2，结束于4。
​    进一步说明："/b" 与 "^" 和 "$" 类似，本身不匹配任何字符，但是它要求它在匹配结果中所处位置的左右两边，其中一边是 "/w" 范围，另一边是 非"/w" 的范围。



### 1.2修饰符

| 修饰符  | 描述                          |
| ---- | --------------------------- |
| i    | 执行对大小写不敏感的匹配                |
| g    | 执行全局匹配（查找所有匹配而非在找到第一个匹配后停止） |
| m    | 执行多行匹配。                     |



### 1.3模式

| 表达式    | 描述              | 表达式       | 描述               |
| ------ | --------------- | --------- | ---------------- |
| [ab5@] | 匹配a、b、5、@中的一个字符 | [^abc]    | 匹配a、b、c以外的字符     |
| [f-k]  | 匹配f~k之间的字符      | [^A-F0_3] | 匹配A~F、0~3以外的任意字符 |



### 1.4其他

| 元符号  | 描述                                 |
| ---- | ---------------------------------- |
| "\|" | 能够进行或运算，匹配左边或右边                    |
| ()   | 括号里的内容可以看做一个整体，能够使用""$1"的方式获取匹配的结果 |



### 1.5贪婪匹配和非贪婪匹配

**贪婪模式**

​	在使用修饰匹配次数的特殊符号时，有几种表示方法可以使同一个表达式能够匹配不同的次数，比如："{m,n}", "{m,}", "?", "*", "+"，具体匹配的次数随被匹配的字符串而定。这种重复匹配不定次数的表达式在匹配过程中，总是尽可能多的匹配。比如，针对文本 "dxxxdxxxd"，举例如下：

| 表达式         | 匹配结果                                     |
| ----------- | ---------------------------------------- |
| (d)(\w+)    | "/w+" 将匹配第一个 "d" 之后的所有字符 "xxxdxxxd"      |
| (d)(/w+)(d) | "/w+" 将匹配第一个 "d" 和最后一个 "d" 之间的所有字符 "xxxdxxx"。虽然 "/w+" 也能够匹配上最后一个 "d"，但是为了使整个表达式匹配成功，"/w+" 可以 "让出" 它本来能够匹配的最后一个 "d" |

**非贪婪模式**

​    在修饰匹配次数的特殊符号后再加上一个 "?" 号，则可以使匹配次数不定的表达式尽可能少的匹配，使可匹配可不匹配的表达式，尽可能的 "不匹配"。这种匹配原则叫作 "非贪婪" 模式，也叫作 "勉强" 模式。如果少匹配就会导致整个表达式匹配失败的时候，与贪婪模式类似，非贪婪模式会最小限度的再匹配一些，以使整个表达式匹配成功。举例如下，针对文本 "dxxxdxxxd" 举例：

| 表达式          | 匹配结果                                     |
| ------------ | ---------------------------------------- |
| (d)(\w+?)    | "/w+?" 将尽可能少的匹配第一个 "d" 之后的字符，结果是："/w+?" 只匹配了一个 "x" |
| (d)(\w+?)(d) | 为了让整个表达式匹配成功，"/w+?" 不得不匹配 "xxx" 才可以让后边的 "d" 匹配，从而使整个表达式匹配成功。因此，结果是："/w+?" 匹配 "xxx" |

## 2.实际问题

### 2.1解析不标准的json数据

今天遇到一串不标准的json数据：

{"warning":{message:"用户会话已到期。请重新装入页面。\<br />",details:"\<br />"}}

可以看到它的message和details是没有加双引号的，我们可以使用正则表达式为它补充上，否则js不能解析该json数据，代码如下。

```javascript
data.replace(/(\s*?{\s*?|\s*?,\s*?)(['"])?([a-zA-Z0-9]+)(['"])?:/g, '$1"$3":');
eval('var rel = new Object(' + data + ')');
```



### 2.2去掉html标签

```javascript
var msg = "<SPAN class=\"ellipsis\">...<\/SPAN> <SPAN class=\"OFHighlightTerm1\">深圳<\/SPAN>燃气2017年年度报告 2018-06-11 | 来源:董事办 | 作者:郭鋆辉 | 摄影:董事办 <SPAN class=\"ellipsis\">...<\/SPAN> 收藏 《<SPAN class=\"OFHighlightTerm1\">深圳<\/SPAN>燃气2017年年度报告》全文请见附件 附件: [打印本文] [关闭窗口] [复制地址"
```

像上面的字符串，它里面包好有html标签，如果我们希望把html去掉，可以使用正则表达式，代码如下：

```javascript
msg = msg.replace(/<[^>]+>/g, "");
```

